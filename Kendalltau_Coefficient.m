%  程序名称: Kendall's tau coefficient and Sprearman coefficient
%  程序功能: 计算了个序列间的Kendall's tau相关系数和Sprearman关系数
%  数据输入：各数组序列

clc,clear all;
format short g;
fprintf(2,'Kendall tau coefficient：\n')

Degree = [0.433636684	0.6396 	0.678512014	0.813085851	0.593944633	0.394565734	0.48700633	0.715085672	0.707862557	0.600592498	0.519187303	0.378504419	0.28193039	0.458951289	0.540986258	0.413745324	0.394149067	0.218505443	0.226667539	0.659414071	0.640630884	0.655018997	0.536847395	0.559817638	0.740663475	0.534624894	0.554049314
0.583392261	0.7596 	0.658154721	0.771469279	0.655390873	0.553263667	0.681065741	0.799451269	0.77429632	0.698814124	0.666655663	0.602231576	0.492476983	0.603704034	0.600986739	0.655505139	0.496975879	0.459712118	0.475640098	0.766299361	0.74911002	0.776877934	0.680678501	0.678783913	0.808901068	0.685416863	0.691006329
0.7772 	0.849718313	0.713902302	0.739050182	0.742094162	0.712103457	0.866054481	0.91495642	0.885945601	0.838421459	0.831788727	0.806486514	0.682021546	0.7007883	0.683294991	0.92366086	0.678787016	0.557192788	0.60632276	0.890362897	0.916335294	0.950862525	0.890627174	0.861332201	0.986364881	0.928742398	0.934372651
0.701891933	0.8631 	0.637147331	0.727475839	0.711550537	0.675662084	0.830978893	0.875726638	0.835464051	0.784838207	0.78695876	0.762954878	0.636853525	0.719917242	0.655518107	0.829571445	0.581907692	0.612311876	0.633315745	0.860001456	0.84375572	0.882059386	0.799025229	0.779807293	0.871813909	0.808559691	0.80498997
0.829596037	0.9202 	0.797104884	0.846368117	0.833801467	0.815863301	0.897327763	0.924139333	0.905367555	0.87693102	0.876959283	0.860015818	0.785992953	0.83842302	0.804531797	0.89533753	0.76311442	0.777231009	0.78588717	0.918369476	0.910416193	0.929365234	0.880621721	0.873393507	0.922879956	0.890348883	0.883650798
0.957300141	0.9773 	0.957062437	0.965260395	0.956052397	0.956064519	0.963676632	0.972552027	0.975271058	0.969023833	0.966959807	0.957076759	0.93513238	0.956928798	0.953545486	0.961103616	0.944321149	0.942150142	0.938458596	0.976737496	0.977076666	0.976671082	0.962218212	0.966979721	0.973946003	0.972138076	0.962311627
0.7193 	0.9393 	0.8375 	0.9000 	0.8694 	0.7192 	0.7806 	0.9019 	0.9170 	0.8480 	0.8180 	0.6403 	0.1460 	0.8257 	0.6910 	0.7176 	0.3734 	0.2187 	0.2366 	0.9070 	0.9188 	0.9360 	0.7109 	0.8268 	0.8729 	0.8555 	0.6898 
7.1592 	7.1455 	7.1234 	7.1790 	6.6494 	7.1440 	7.3014 	7.2110 	7.1708 	7.0917 	7.1647 	7.1256 	7.0676 	6.9988 	6.9478 	7.2764 	7.2621 	7.2519 	6.6975 	6.3954 	7.2942 	6.9076 	7.1617 	7.2462 	7.2601 	7.1410 	7.2763 
66389	48213	46497	39247	52323	68203	59286	45982	46123	53421	59418	80554	95632	63370	57551	72833	76683	113826	96548	50433	54278	51175	65617	57976	43277	62786	77006];

MEAM = [70.21 	79.04 	79.38 	83.21 	76.38 	69.71 	73.75 	80.83 	80.54 	76.71 	73.92 	65.08 	59.50 	71.75 	74.79 	68.38 	66.79 	53.67 	59.33 	78.63 	77.25 	78.46 	71.88 	75.75 	81.71 	73.83 	67.17 ];
MAX = [86	104	97	101	90	87	97	107	107	101	98	89	78	87	96	96	94	74	79	117	117	106	112	122	114	111	103];

Rawdata = [Degree;MEAM];

[x,y] = size(Rawdata);

City = [1:y];

%%  按照每月浓度数据对城市排序
rank = []; % 对象/指标关联序矩阵
rank_1 = []; % 排序后的关联度矩阵
for z = 1:x
    degree_z = [City;Rawdata(z,:);MEAM]; 
    order_z = sortrows((degree_z)',2); % 针对每个指标/对象进行排序
    order = (order_z(:,1))'; % 提取关联序
    rank = [rank;order];
    order1 = (order_z(:,2))'; 
    rank_1 = [rank_1;order1]; % 排序后的关联度矩阵
end

%%  按照城市排序得出城市的排名
Rank = []; % 对象/指标关联序矩阵
Rank_1 = []; % 排序后的关联度矩阵
for z = 1:x
    Degree_z = [City;rank(z,:)]; 
    Order_z = sortrows((Degree_z)',2); % 针对第二列从小到大排序
    Order = (Order_z(:,1))'; % 提取关联序
    Rank = [Rank;Order];
    Order1 = (Order_z(:,2))'; 
    Rank_1 = [Rank_1;Order1]; % 排序后的关联度矩阵
end


%% 计算Kendall tau 相关系数
Tau = [];
P_t = [];
for s = 1:x-1
    [rho,pval] = corr(Rawdata(s,:)',Rawdata(x,:)','Type','Kendall');
    Tau = [Tau;rho];
    P_t = [P_t;pval];    
end

%% 计算Sprearman 相关系数
Spe = [];
P_s = [];
for s = 1:x-1
    [rho,pval] = corr(Rawdata(s,:)',Rawdata(x,:)','Type','Spearman');
    Spe = [Spe;rho];
    P_s = [P_s;pval];    
end

% 结果输出
disp('Kendalltau_c:');
disp(Tau);
disp('Sprearman_c:');
disp(Spe);

% EU = pdist(data,"cosine");